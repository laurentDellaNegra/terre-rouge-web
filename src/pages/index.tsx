import { QueryClient, dehydrate, useQuery } from '@tanstack/react-query'
import type { NextPage } from 'next'
import Head from 'next/head'

import Hero from '@/atomic/organisms/Hero'
import HorizontalProducts from '@/atomic/organisms/horizontalProducts'
import Incentives from '@/components/Incentives'
import Layout from '@/components/Layout'
import LogoClouds from '@/components/LogoClouds'
import Story from '@/components/Story'
import Testimonial from '@/components/Testimonial'
import getShopPageForHome from '@/lib/getShopPageForHome'
import { getTrustpilotReviews } from '@/lib/trustpilot'

const Home: NextPage = () => {
  // const { status, data, error, isFetching } = useQuery(['shopHome'], getShopPageForHome)
  // console.log('shop', data)
  // console.log('status', status)
  // console.log('error', error)
  // console.log('isFetching', isFetching)
  return (
    <>
      <Head>
        <title>Terre Rouge</title>
        <meta name="description" content="Generated by create next app" />
      </Head>
      <Layout>
        <Hero />
        <HorizontalProducts />
        <Story />
        <LogoClouds />
        <Testimonial />
        <Incentives />
      </Layout>
    </>
  )
}
export async function getStaticProps() {
  const queryClient = new QueryClient()

  await queryClient.prefetchQuery(['shopHome'], getShopPageForHome)
  await queryClient.prefetchQuery(['reviews'], getTrustpilotReviews)
  return {
    props: {
      dehydratedState: dehydrate(queryClient),
    },
  }
}
export default Home
